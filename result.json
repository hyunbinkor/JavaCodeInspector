{
  "fileName": "test_code.java",
  "analysisDate": "2025-10-02T05:09:29.728Z",
  "sourceCodeLines": 105,
  "result": "ISSUES_FOUND",
  "patternClassification": {
    "safePatterns": [],
    "antiPatterns": [
      {
        "title": "결제 처리 중 예외 처리 누락으로 인한 데이터 일관성 문제",
        "category": "exception_handling"
      },
      {
        "title": "데이터베이스 커넥션 누수로 인한 서비스 장애",
        "category": "resource_management"
      },
      {
        "title": "SQL 인젝션 취약점 - 문자열 연결을 통한 동적 쿼리 생성",
        "category": "security_vulnerability"
      },
      {
        "title": "파일 스트림 리소스 누수로 인한 메모리 부족 오류",
        "category": "resource_management"
      },
      {
        "title": "비효율적인 컬렉션 사용으로 인한 성능 저하",
        "category": "performance_issue"
      }
    ]
  },
  "safePracticesFound": [],
  "detectedIssues": [
    {
      "id": "issue_6",
      "title": "SQL 인젝션 취약점 - 문자열 연결을 통한 동적 쿼리 생성",
      "description": "SQL Injection 취약점: 문자열 연결로 SQL 생성",
      "severity": "MEDIUM",
      "category": "security_vulnerability",
      "location": {
        "startLine": 70,
        "endLine": 70,
        "startColumn": 0,
        "endColumn": 0
      },
      "codeSnippet": "        // SQL Injection vulnerability!\n        String sql = \"DELETE FROM users WHERE id = \" + userId;\n        PreparedStatement stmt = conn.prepareStatement(sql);",
      "patternInfo": {
        "confidence": 0.95
      },
      "relatedPattern": {
        "id": "SECURITY_296901_560",
        "title": "SQL 인젝션 취약점 - 문자열 연결을 통한 동적 쿼리 생성",
        "category": "security_vulnerability",
        "severity": "CRITICAL",
        "semanticSignature": "string_concatenation_sql_injection",
        "astSignature": "{\"structural\":{\"nodePattern\":\"ClassDeclaration->MethodDeclaration->MethodDeclaration->VariableDeclaration->VariableDeclaration->VariableDeclaration\",\"depthPattern\":2,\"complexityPattern\":1},\"semantic\":{\"resourcePattern\":\"\",\"securityPattern\":\"\",\"frameworkPattern\":\"@Service,@Autowired\"},\"behavioral\":{\"methodCallPattern\":\"jdbcTemplate.query->jdbcTemplate.queryForObject\",\"controlFlowPattern\":\"\",\"exceptionPattern\":\"\"}}",
        "cyclomaticComplexity": 1,
        "maxDepth": 2,
        "qualityScore": 0.9,
        "fullData": {
          "issue_record_id": "SECURITY_296901_560",
          "metadata": {
            "title": "SQL 인젝션 취약점 - 문자열 연결을 통한 동적 쿼리 생성",
            "category": "security_vulnerability",
            "severity": "CRITICAL",
            "tags": [
              "SQL인젝션",
              "보안취약점",
              "데이터베이스",
              "파라미터바인딩"
            ],
            "created_date": "2024-02-03T14:15:00Z",
            "last_updated": "2025-09-30T07:11:36.901Z"
          },
          "anti_pattern": {
            "code_template": "String sql = \"SELECT * FROM table WHERE column = '\" + userInput + \"'\"; jdbcTemplate.query(sql, rowMapper);",
            "pattern_signature": {
              "semantic_signature": "string_concatenation_sql_injection",
              "regex_patterns": [
                "\".*\\+\\s*\\w+\\s*\\+.*\"",
                "jdbcTemplate\\.query\\([^?]*\\+[^,]*,"
              ]
            },
            "problematic_characteristics": {
              "missing_operations": [
                "파라미터 바인딩 사용",
                "입력값 검증",
                "SQL 이스케이프 처리"
              ],
              "incorrect_usage": [
                "문자열 연결로 SQL 쿼리 생성",
                "사용자 입력값 직접 삽입",
                "PreparedStatement 미사용"
              ],
              "framework_violations": [
                "JdbcTemplate 파라미터 바인딩 미활용",
                "Spring Security 권장사항 위반",
                "OWASP 보안 가이드라인 위반"
              ]
            }
          },
          "recommended_pattern": {
            "code_template": "String sql = \"SELECT * FROM table WHERE column = ?\"; jdbcTemplate.query(sql, rowMapper, parameter);",
            "pattern_name": "parameterized_query_pattern",
            "implementation_guide": {
              "best_practices": [
                "모든 동적 값에 파라미터 바인딩 사용",
                "입력값 검증 및 길이 제한",
                "최소 권한 원칙으로 데이터베이스 접근",
                "정기적인 보안 감사 수행"
              ],
              "framework_specific_notes": [
                "JdbcTemplate의 파라미터 바인딩 기능 활용",
                "Spring Security와 연계한 접근 제어",
                "MyBatis 사용 시 #{} 파라미터 바인딩 사용",
                "JPA 사용 시 JPQL 파라미터 바인딩 활용"
              ]
            }
          },
          "impact_analysis": {
            "production_impact": {
              "failure_scenarios": [
                "악의적 SQL 쿼리 실행으로 인한 데이터 유출",
                "데이터베이스 구조 정보 노출",
                "무단 데이터 수정 및 삭제",
                "시스템 권한 탈취"
              ],
              "performance_degradation": {
                "response_time_impact": "SQL 인젝션 공격 시 복잡한 쿼리 실행으로 응답 시간 급격히 증가",
                "throughput_impact": "데이터베이스 리소스 고갈로 인한 전체 시스템 처리량 저하",
                "resource_consumption": "CPU 및 메모리 사용량 급증, 데이터베이스 연결 풀 고갈"
              }
            },
            "historical_data": {
              "occurrence_frequency": 8,
              "fix_effort_estimation": {
                "complexity": "LOW",
                "estimated_hours": 2,
                "required_expertise": [
                  "자바 개발자"
                ]
              }
            }
          },
          "embeddings": {
            "combined_embedding": [
              0.07735231452355236,
              0.15470462904710472,
              0.2320569435706571,
              0.09282277742826285,
              0.023205694357065713,
              0.027846833228478852,
              0.06961708307119713,
              0.09282277742826285,
              0,
              0,
              0,
              0,
              0,
              0.4641138871413142,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0.11602847178532855,
              0,
              0,
              0,
              0,
              0,
              0.4641138871413142,
              0,
              0,
              0,
              0,
              0,
              0,
              0.023205694357065713,
              0.09282277742826285,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0.4641138871413142,
              0,
              0,
              0.4641138871413142,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0.09282277742826285,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0
            ],
            "component_embeddings": {
              "syntactic_embedding": [
                0.16666666666666666,
                0.3333333333333333,
                0.5,
                0.2,
                0.05,
                0.06,
                0.15,
                0.2,
                0,
                0,
                0,
                0,
                0,
                1,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0
              ],
              "semantic_embedding": [
                0,
                0.25,
                0,
                0,
                0,
                0,
                0,
                1,
                0,
                0,
                0,
                0,
                0,
                0,
                0.05,
                0.2,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0
              ],
              "framework_embedding": [
                0,
                1,
                0,
                0,
                1,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0
              ],
              "context_embedding": [
                0,
                0,
                0.2,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0
              ]
            },
            "embedding_metadata": {
              "embedding_version": "v1.0",
              "created_timestamp": "2025-09-30T07:11:36.901Z",
              "model_version": "CustomEmbedding-1.0.0"
            },
            "ast_analysis": {
              "success": true,
              "nodeTypes": [
                "ClassDeclaration",
                "MethodDeclaration",
                "MethodDeclaration",
                "VariableDeclaration",
                "VariableDeclaration",
                "VariableDeclaration"
              ],
              "cyclomaticComplexity": 1,
              "maxDepth": 2,
              "signature": "{\"structural\":{\"nodePattern\":\"ClassDeclaration->MethodDeclaration->MethodDeclaration->VariableDeclaration->VariableDeclaration->VariableDeclaration\",\"depthPattern\":2,\"complexityPattern\":1},\"semantic\":{\"resourcePattern\":\"\",\"securityPattern\":\"\",\"frameworkPattern\":\"@Service,@Autowired\"},\"behavioral\":{\"methodCallPattern\":\"jdbcTemplate.query->jdbcTemplate.queryForObject\",\"controlFlowPattern\":\"\",\"exceptionPattern\":\"\"}}",
              "resourceLeakRisks": [],
              "securityPatterns": [],
              "performanceIssues": [],
              "methodDeclarations": [
                {
                  "returnType": "new",
                  "name": "ProductRowMapper",
                  "parameters": ""
                },
                {
                  "returnType": "Product",
                  "name": "findProductById",
                  "parameters": "String id"
                },
                {
                  "returnType": "new",
                  "name": "ProductRowMapper",
                  "parameters": ""
                }
              ],
              "classDeclarations": [
                {
                  "name": "ProductService",
                  "extends": null,
                  "implements": []
                }
              ]
            }
          },
          "related_patterns": [],
          "detection_rules": {
            "ast_rules": [
              {
                "rule_name": "spring_service_annotation_detection",
                "rule_expression": "AnnotationExpr[@Service] && ClassOrInterfaceDeclaration",
                "confidence_score": 0.9
              },
              {
                "rule_name": "dependency_injection_pattern",
                "rule_expression": "FieldDeclaration[AnnotationExpr[@Autowired]]",
                "confidence_score": 0.85
              },
              {
                "rule_name": "jdbc_template_usage",
                "rule_expression": "VariableDeclarator[Type[JdbcTemplate]]",
                "confidence_score": 0.8
              }
            ],
            "semantic_rules": [
              {
                "rule_name": "spring_service_layer_pattern",
                "rule_description": "Spring Framework의 서비스 계층 구현 패턴으로 비즈니스 로직을 담당하는 컴포넌트를 식별",
                "pattern_indicators": [
                  "@Service",
                  "Service",
                  "@Autowired"
                ]
              },
              {
                "rule_name": "spring_data_access_pattern",
                "rule_description": "Spring JDBC를 사용한 데이터 접근 계층 패턴으로 데이터베이스 연동 로직을 식별",
                "pattern_indicators": [
                  "JdbcTemplate",
                  "FROM",
                  "WHERE",
                  "OR"
                ]
              },
              {
                "rule_name": "domain_model_pattern",
                "rule_description": "도메인 모델 객체 패턴으로 비즈니스 엔티티를 나타내는 클래스를 식별",
                "pattern_indicators": [
                  "Product"
                ]
              }
            ]
          },
          "framework_context": {
            "framework_version": "Spring_Framework_5.x_or_later",
            "applicable_components": {
              "custom_annotations": [
                "@Service",
                "@Autowired"
              ],
              "custom_classes": [
                "Service",
                "Autowired",
                "JdbcTemplate",
                "FROM",
                "WHERE",
                "OR",
                "Product"
              ],
              "framework_apis": [
                "org.springframework.stereotype.Service",
                "org.springframework.beans.factory.annotation.Autowired",
                "org.springframework.jdbc.core.JdbcTemplate"
              ]
            }
          },
          "validation_info": {
            "reviewed_by": "system_generated",
            "review_date": "2025-09-30",
            "validation_status": "DRAFT",
            "quality_score": 0.9
          }
        },
        "type": "anti_pattern"
      },
      "fixSuggestion": {
        "steps": [
          "문자열 연결로 동적 쿼리를 생성하는 부분을 파라미터화된 쿼리로 변경",
          "PreparedStatement의 setInt() 메서드를 사용하여 userId 값을 안전하게 바인딩",
          "입력값 검증 로직을 추가하여 userId가 유효한 값인지 확인"
        ],
        "fixedCode": "        // Input validation\n        if (userId <= 0) {\n            throw new IllegalArgumentException(\"Invalid user ID: \" + userId);\n        }\n        \n        // Use parameterized query to prevent SQL injection\n        String sql = \"DELETE FROM users WHERE id = ?\";\n        PreparedStatement stmt = conn.prepareStatement(sql);\n        stmt.setInt(1, userId);",
        "explanation": "기존 코드는 문자열 연결을 통해 SQL 쿼리를 동적으로 생성하여 SQL 인젝션 공격에 취약했습니다. 수정된 코드는 다음과 같은 보안 강화를 제공합니다: 1) 파라미터화된 쿼리(?)를 사용하여 SQL과 데이터를 분리함으로써 악의적인 SQL 코드 삽입을 원천 차단, 2) PreparedStatement의 setInt() 메서드를 통해 타입 안전성을 보장하고 자동으로 이스케이프 처리, 3) 입력값 검증을 통해 유효하지 않은 userId 값에 대한 사전 차단. 이러한 수정으로 SQL 인젝션 취약점을 완전히 해결할 수 있습니다.",
        "confidence": 0.95,
        "patternBasedSuggestions": [
          "입력값 검증",
          "파라미터화된 쿼리 사용"
        ],
        "codeExample": "// 패턴 정보 없음",
        "frameworkNotes": []
      }
    },
    {
      "id": "issue_2",
      "title": "데이터베이스 커넥션 누수로 인한 서비스 장애",
      "description": "Database Connection이 닫히지 않아 리소스 누수 위험",
      "severity": "MEDIUM",
      "category": "resource_management",
      "location": {
        "startLine": 48,
        "endLine": 48,
        "startColumn": 0,
        "endColumn": 0
      },
      "codeSnippet": "        try {\n            conn = dataSource.getConnection();\n            PreparedStatement stmt = conn.prepareStatement(\"SELECT COUNT(*) FROM users\");",
      "patternInfo": {
        "confidence": 0.9
      },
      "relatedPattern": {
        "id": "RESOURCE_227296_677",
        "title": "데이터베이스 커넥션 누수로 인한 서비스 장애",
        "category": "resource_management",
        "severity": "HIGH",
        "semanticSignature": "unclosed_database_connection",
        "astSignature": "{\"structural\":{\"nodePattern\":\"ClassDeclaration->MethodDeclaration->VariableDeclaration->VariableDeclaration->VariableDeclaration\",\"depthPattern\":2,\"complexityPattern\":1},\"semantic\":{\"resourcePattern\":\"Connection:undefined,PreparedStatement:undefined,Statement:undefined\",\"securityPattern\":\"sql_injection\",\"frameworkPattern\":\"@Service,@Autowired\"},\"behavioral\":{\"methodCallPattern\":\"dataSource.getConnection->conn.prepareStatement->stmt.executeUpdate->conn.close\",\"controlFlowPattern\":\"\",\"exceptionPattern\":\"\"}}",
        "cyclomaticComplexity": 1,
        "maxDepth": 2,
        "qualityScore": 0.9,
        "fullData": {
          "issue_record_id": "RESOURCE_227296_677",
          "metadata": {
            "title": "데이터베이스 커넥션 누수로 인한 서비스 장애",
            "category": "resource_management",
            "severity": "HIGH",
            "tags": [
              "커넥션풀",
              "리소스누수",
              "데이터베이스",
              "메모리누수"
            ],
            "created_date": "2024-01-15T09:30:00Z",
            "last_updated": "2025-09-30T07:10:27.296Z"
          },
          "anti_pattern": {
            "code_template": "Connection conn = dataSource.getConnection();\n// 데이터베이스 작업 수행\n// conn.close() 누락",
            "pattern_signature": {
              "semantic_signature": "unclosed_database_connection",
              "regex_patterns": [
                "Connection\\s+\\w+\\s*=\\s*.*\\.getConnection\\(\\)",
                "(?!.*close\\(\\)).*getConnection\\(\\).*"
              ]
            },
            "problematic_characteristics": {
              "missing_operations": [
                "커넥션 자원 해제",
                "예외 상황에서의 리소스 정리"
              ],
              "incorrect_usage": [
                "수동 커넥션 관리",
                "SQL 인젝션 취약한 문자열 연결"
              ],
              "framework_violations": [
                "Spring 트랜잭션 관리 미사용",
                "try-with-resources 패턴 미적용"
              ]
            }
          },
          "recommended_pattern": {
            "code_template": "try (Connection conn = dataSource.getConnection()) {\n    // 데이터베이스 작업 수행\n    // 자동으로 리소스 해제됨\n}",
            "pattern_name": "try_with_resources_pattern",
            "implementation_guide": {
              "best_practices": [
                "try-with-resources 구문 사용",
                "PreparedStatement로 SQL 인젝션 방지",
                "Spring @Transactional 어노테이션 활용"
              ],
              "framework_specific_notes": [
                "Spring Boot에서는 JdbcTemplate 사용 권장",
                "커넥션 풀 설정 최적화 필요"
              ]
            }
          },
          "impact_analysis": {
            "production_impact": {
              "failure_scenarios": [
                "커넥션 풀 고갈로 인한 서비스 중단",
                "피크 시간대 응답 불가"
              ],
              "performance_degradation": {
                "response_time_impact": "커넥션 대기 시간 증가로 응답 시간이 기하급수적으로 증가",
                "throughput_impact": "동시 처리 가능한 요청 수가 커넥션 풀 크기로 제한되어 처리량 급감",
                "resource_consumption": "미해제된 커넥션이 메모리와 데이터베이스 리소스를 지속적으로 점유"
              }
            },
            "historical_data": {
              "occurrence_frequency": 15,
              "fix_effort_estimation": {
                "complexity": "LOW",
                "estimated_hours": 2,
                "required_expertise": [
                  "자바 개발자"
                ]
              }
            }
          },
          "embeddings": {
            "combined_embedding": [
              0.07989708780977135,
              0.07989708780977135,
              0.23969126342931404,
              0.07989708780977135,
              0.019974271952442838,
              0.019974271952442838,
              0.05992281585732851,
              0.07989708780977135,
              0,
              0,
              0,
              0,
              0,
              0.39948543904885675,
              0,
              0.39948543904885675,
              0,
              0,
              0.07989708780977135,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0.09987135976221419,
              0.09987135976221419,
              0,
              0,
              0.23969126342931404,
              0,
              0,
              0.39948543904885675,
              0.13316181301628557,
              0,
              0,
              0,
              0,
              0,
              0.019974271952442838,
              0.07989708780977135,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0.39948543904885675,
              0,
              0,
              0.39948543904885675,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0.07989708780977135,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0
            ],
            "component_embeddings": {
              "syntactic_embedding": [
                0.2,
                0.2,
                0.6,
                0.2,
                0.05,
                0.05,
                0.15,
                0.2,
                0,
                0,
                0,
                0,
                0,
                1,
                0,
                1,
                0,
                0,
                0.2,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0
              ],
              "semantic_embedding": [
                0.25,
                0.25,
                0,
                0,
                0.6,
                0,
                0,
                1,
                0.3333333333333333,
                0,
                0,
                0,
                0,
                0,
                0.05,
                0.2,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0
              ],
              "framework_embedding": [
                0,
                1,
                0,
                0,
                1,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0
              ],
              "context_embedding": [
                0.2,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0
              ]
            },
            "embedding_metadata": {
              "embedding_version": "v1.0",
              "created_timestamp": "2025-09-30T07:10:27.295Z",
              "model_version": "CustomEmbedding-1.0.0"
            },
            "ast_analysis": {
              "success": true,
              "nodeTypes": [
                "ClassDeclaration",
                "MethodDeclaration",
                "VariableDeclaration",
                "VariableDeclaration",
                "VariableDeclaration"
              ],
              "cyclomaticComplexity": 1,
              "maxDepth": 2,
              "signature": "{\"structural\":{\"nodePattern\":\"ClassDeclaration->MethodDeclaration->VariableDeclaration->VariableDeclaration->VariableDeclaration\",\"depthPattern\":2,\"complexityPattern\":1},\"semantic\":{\"resourcePattern\":\"Connection:undefined,PreparedStatement:undefined,Statement:undefined\",\"securityPattern\":\"sql_injection\",\"frameworkPattern\":\"@Service,@Autowired\"},\"behavioral\":{\"methodCallPattern\":\"dataSource.getConnection->conn.prepareStatement->stmt.executeUpdate->conn.close\",\"controlFlowPattern\":\"\",\"exceptionPattern\":\"\"}}",
              "resourceLeakRisks": [],
              "securityPatterns": [
                {
                  "type": "sql_injection",
                  "description": "String concatenation in SQL query",
                  "severity": "HIGH"
                }
              ],
              "performanceIssues": [],
              "methodDeclarations": [
                {
                  "returnType": "User",
                  "name": "createUser",
                  "parameters": "String name, String email"
                },
                {
                  "returnType": "INTO",
                  "name": "users",
                  "parameters": "name, email"
                },
                {
                  "returnType": "return",
                  "name": "findUserByName",
                  "parameters": "name"
                }
              ],
              "classDeclarations": [
                {
                  "name": "UserService",
                  "extends": null,
                  "implements": []
                }
              ]
            }
          },
          "related_patterns": [],
          "detection_rules": {
            "ast_rules": [
              {
                "rule_name": "spring_service_annotation_detection",
                "rule_expression": "AnnotationExpr[@Service] && ClassOrInterfaceDeclaration",
                "confidence_score": 0.9
              },
              {
                "rule_name": "dependency_injection_pattern",
                "rule_expression": "FieldDeclaration[AnnotationExpr[@Autowired]]",
                "confidence_score": 0.85
              },
              {
                "rule_name": "jdbc_database_operation",
                "rule_expression": "MethodCallExpr[PreparedStatement] && VariableDeclarator[DataSource|Connection]",
                "confidence_score": 0.8
              }
            ],
            "semantic_rules": [
              {
                "rule_name": "spring_service_layer_pattern",
                "rule_description": "Spring Framework의 서비스 계층 패턴으로 비즈니스 로직을 담당하는 컴포넌트를 식별",
                "pattern_indicators": [
                  "@Service",
                  "Service",
                  "비즈니스 로직 처리"
                ]
              },
              {
                "rule_name": "spring_dependency_injection",
                "rule_description": "Spring의 의존성 주입 패턴으로 객체 간의 의존관계를 자동으로 설정",
                "pattern_indicators": [
                  "@Autowired",
                  "의존성 주입",
                  "IoC 컨테이너"
                ]
              },
              {
                "rule_name": "jdbc_data_access_pattern",
                "rule_description": "JDBC를 사용한 데이터베이스 접근 패턴으로 SQL 쿼리 실행 및 데이터 조작",
                "pattern_indicators": [
                  "DataSource",
                  "Connection",
                  "PreparedStatement",
                  "INSERT",
                  "데이터베이스 연결"
                ]
              }
            ]
          },
          "framework_context": {
            "framework_version": "Spring_Framework_5.x_or_later",
            "applicable_components": {
              "custom_annotations": [
                "@Service",
                "@Autowired"
              ],
              "custom_classes": [
                "Service",
                "Autowired",
                "DataSource",
                "User",
                "Connection",
                "INSERT",
                "PreparedStatement"
              ],
              "framework_apis": [
                "Spring IoC Container",
                "Spring Data Access",
                "JDBC Template",
                "Spring Bean Management"
              ]
            }
          },
          "validation_info": {
            "reviewed_by": "system_generated",
            "review_date": "2025-09-30",
            "validation_status": "DRAFT",
            "quality_score": 0.9
          }
        },
        "type": "anti_pattern"
      },
      "fixSuggestion": {
        "steps": [
          "기존의 try-catch 블록을 try-with-resources 구문으로 변경하여 Connection과 PreparedStatement를 자동으로 관리하도록 수정",
          "리소스 선언을 try 괄호 안으로 이동하여 블록 종료 시 자동으로 close()가 호출되도록 구현"
        ],
        "fixedCode": "        try (Connection conn = dataSource.getConnection();\n             PreparedStatement stmt = conn.prepareStatement(\"SELECT COUNT(*) FROM users\")) {",
        "explanation": "try-with-resources 구문을 사용하면 AutoCloseable 인터페이스를 구현한 리소스(Connection, PreparedStatement)가 try 블록이 끝날 때 자동으로 close() 메서드가 호출됩니다. 이는 예외가 발생하더라도 리소스가 확실히 해제되어 커넥션 풀 고갈이나 메모리 누수를 방지할 수 있습니다. 기존 코드에서는 예외 발생 시 finally 블록에서 명시적으로 close()를 호출해야 했지만, try-with-resources를 사용하면 이런 번거로움 없이 안전하게 리소스를 관리할 수 있습니다.",
        "confidence": 0.95,
        "patternBasedSuggestions": [
          "리소스 자동 관리 구현",
          "try-with-resources 사용"
        ],
        "codeExample": "// 패턴 정보 없음",
        "frameworkNotes": []
      }
    },
    {
      "id": "issue_3",
      "title": "데이터베이스 커넥션 누수로 인한 서비스 장애",
      "description": "Database Connection이 닫히지 않아 리소스 누수 위험",
      "severity": "MEDIUM",
      "category": "resource_management",
      "location": {
        "startLine": 67,
        "endLine": 67,
        "startColumn": 0,
        "endColumn": 0
      },
      "codeSnippet": "    public void deleteUser(String userId) throws SQLException {\n        Connection conn = dataSource.getConnection();\n        ",
      "patternInfo": {
        "confidence": 0.9
      },
      "relatedPattern": {
        "id": "RESOURCE_227296_677",
        "title": "데이터베이스 커넥션 누수로 인한 서비스 장애",
        "category": "resource_management",
        "severity": "HIGH",
        "semanticSignature": "unclosed_database_connection",
        "astSignature": "{\"structural\":{\"nodePattern\":\"ClassDeclaration->MethodDeclaration->VariableDeclaration->VariableDeclaration->VariableDeclaration\",\"depthPattern\":2,\"complexityPattern\":1},\"semantic\":{\"resourcePattern\":\"Connection:undefined,PreparedStatement:undefined,Statement:undefined\",\"securityPattern\":\"sql_injection\",\"frameworkPattern\":\"@Service,@Autowired\"},\"behavioral\":{\"methodCallPattern\":\"dataSource.getConnection->conn.prepareStatement->stmt.executeUpdate->conn.close\",\"controlFlowPattern\":\"\",\"exceptionPattern\":\"\"}}",
        "cyclomaticComplexity": 1,
        "maxDepth": 2,
        "qualityScore": 0.9,
        "fullData": {
          "issue_record_id": "RESOURCE_227296_677",
          "metadata": {
            "title": "데이터베이스 커넥션 누수로 인한 서비스 장애",
            "category": "resource_management",
            "severity": "HIGH",
            "tags": [
              "커넥션풀",
              "리소스누수",
              "데이터베이스",
              "메모리누수"
            ],
            "created_date": "2024-01-15T09:30:00Z",
            "last_updated": "2025-09-30T07:10:27.296Z"
          },
          "anti_pattern": {
            "code_template": "Connection conn = dataSource.getConnection();\n// 데이터베이스 작업 수행\n// conn.close() 누락",
            "pattern_signature": {
              "semantic_signature": "unclosed_database_connection",
              "regex_patterns": [
                "Connection\\s+\\w+\\s*=\\s*.*\\.getConnection\\(\\)",
                "(?!.*close\\(\\)).*getConnection\\(\\).*"
              ]
            },
            "problematic_characteristics": {
              "missing_operations": [
                "커넥션 자원 해제",
                "예외 상황에서의 리소스 정리"
              ],
              "incorrect_usage": [
                "수동 커넥션 관리",
                "SQL 인젝션 취약한 문자열 연결"
              ],
              "framework_violations": [
                "Spring 트랜잭션 관리 미사용",
                "try-with-resources 패턴 미적용"
              ]
            }
          },
          "recommended_pattern": {
            "code_template": "try (Connection conn = dataSource.getConnection()) {\n    // 데이터베이스 작업 수행\n    // 자동으로 리소스 해제됨\n}",
            "pattern_name": "try_with_resources_pattern",
            "implementation_guide": {
              "best_practices": [
                "try-with-resources 구문 사용",
                "PreparedStatement로 SQL 인젝션 방지",
                "Spring @Transactional 어노테이션 활용"
              ],
              "framework_specific_notes": [
                "Spring Boot에서는 JdbcTemplate 사용 권장",
                "커넥션 풀 설정 최적화 필요"
              ]
            }
          },
          "impact_analysis": {
            "production_impact": {
              "failure_scenarios": [
                "커넥션 풀 고갈로 인한 서비스 중단",
                "피크 시간대 응답 불가"
              ],
              "performance_degradation": {
                "response_time_impact": "커넥션 대기 시간 증가로 응답 시간이 기하급수적으로 증가",
                "throughput_impact": "동시 처리 가능한 요청 수가 커넥션 풀 크기로 제한되어 처리량 급감",
                "resource_consumption": "미해제된 커넥션이 메모리와 데이터베이스 리소스를 지속적으로 점유"
              }
            },
            "historical_data": {
              "occurrence_frequency": 15,
              "fix_effort_estimation": {
                "complexity": "LOW",
                "estimated_hours": 2,
                "required_expertise": [
                  "자바 개발자"
                ]
              }
            }
          },
          "embeddings": {
            "combined_embedding": [
              0.07989708780977135,
              0.07989708780977135,
              0.23969126342931404,
              0.07989708780977135,
              0.019974271952442838,
              0.019974271952442838,
              0.05992281585732851,
              0.07989708780977135,
              0,
              0,
              0,
              0,
              0,
              0.39948543904885675,
              0,
              0.39948543904885675,
              0,
              0,
              0.07989708780977135,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0.09987135976221419,
              0.09987135976221419,
              0,
              0,
              0.23969126342931404,
              0,
              0,
              0.39948543904885675,
              0.13316181301628557,
              0,
              0,
              0,
              0,
              0,
              0.019974271952442838,
              0.07989708780977135,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0.39948543904885675,
              0,
              0,
              0.39948543904885675,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0.07989708780977135,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0
            ],
            "component_embeddings": {
              "syntactic_embedding": [
                0.2,
                0.2,
                0.6,
                0.2,
                0.05,
                0.05,
                0.15,
                0.2,
                0,
                0,
                0,
                0,
                0,
                1,
                0,
                1,
                0,
                0,
                0.2,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0
              ],
              "semantic_embedding": [
                0.25,
                0.25,
                0,
                0,
                0.6,
                0,
                0,
                1,
                0.3333333333333333,
                0,
                0,
                0,
                0,
                0,
                0.05,
                0.2,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0
              ],
              "framework_embedding": [
                0,
                1,
                0,
                0,
                1,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0
              ],
              "context_embedding": [
                0.2,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0
              ]
            },
            "embedding_metadata": {
              "embedding_version": "v1.0",
              "created_timestamp": "2025-09-30T07:10:27.295Z",
              "model_version": "CustomEmbedding-1.0.0"
            },
            "ast_analysis": {
              "success": true,
              "nodeTypes": [
                "ClassDeclaration",
                "MethodDeclaration",
                "VariableDeclaration",
                "VariableDeclaration",
                "VariableDeclaration"
              ],
              "cyclomaticComplexity": 1,
              "maxDepth": 2,
              "signature": "{\"structural\":{\"nodePattern\":\"ClassDeclaration->MethodDeclaration->VariableDeclaration->VariableDeclaration->VariableDeclaration\",\"depthPattern\":2,\"complexityPattern\":1},\"semantic\":{\"resourcePattern\":\"Connection:undefined,PreparedStatement:undefined,Statement:undefined\",\"securityPattern\":\"sql_injection\",\"frameworkPattern\":\"@Service,@Autowired\"},\"behavioral\":{\"methodCallPattern\":\"dataSource.getConnection->conn.prepareStatement->stmt.executeUpdate->conn.close\",\"controlFlowPattern\":\"\",\"exceptionPattern\":\"\"}}",
              "resourceLeakRisks": [],
              "securityPatterns": [
                {
                  "type": "sql_injection",
                  "description": "String concatenation in SQL query",
                  "severity": "HIGH"
                }
              ],
              "performanceIssues": [],
              "methodDeclarations": [
                {
                  "returnType": "User",
                  "name": "createUser",
                  "parameters": "String name, String email"
                },
                {
                  "returnType": "INTO",
                  "name": "users",
                  "parameters": "name, email"
                },
                {
                  "returnType": "return",
                  "name": "findUserByName",
                  "parameters": "name"
                }
              ],
              "classDeclarations": [
                {
                  "name": "UserService",
                  "extends": null,
                  "implements": []
                }
              ]
            }
          },
          "related_patterns": [],
          "detection_rules": {
            "ast_rules": [
              {
                "rule_name": "spring_service_annotation_detection",
                "rule_expression": "AnnotationExpr[@Service] && ClassOrInterfaceDeclaration",
                "confidence_score": 0.9
              },
              {
                "rule_name": "dependency_injection_pattern",
                "rule_expression": "FieldDeclaration[AnnotationExpr[@Autowired]]",
                "confidence_score": 0.85
              },
              {
                "rule_name": "jdbc_database_operation",
                "rule_expression": "MethodCallExpr[PreparedStatement] && VariableDeclarator[DataSource|Connection]",
                "confidence_score": 0.8
              }
            ],
            "semantic_rules": [
              {
                "rule_name": "spring_service_layer_pattern",
                "rule_description": "Spring Framework의 서비스 계층 패턴으로 비즈니스 로직을 담당하는 컴포넌트를 식별",
                "pattern_indicators": [
                  "@Service",
                  "Service",
                  "비즈니스 로직 처리"
                ]
              },
              {
                "rule_name": "spring_dependency_injection",
                "rule_description": "Spring의 의존성 주입 패턴으로 객체 간의 의존관계를 자동으로 설정",
                "pattern_indicators": [
                  "@Autowired",
                  "의존성 주입",
                  "IoC 컨테이너"
                ]
              },
              {
                "rule_name": "jdbc_data_access_pattern",
                "rule_description": "JDBC를 사용한 데이터베이스 접근 패턴으로 SQL 쿼리 실행 및 데이터 조작",
                "pattern_indicators": [
                  "DataSource",
                  "Connection",
                  "PreparedStatement",
                  "INSERT",
                  "데이터베이스 연결"
                ]
              }
            ]
          },
          "framework_context": {
            "framework_version": "Spring_Framework_5.x_or_later",
            "applicable_components": {
              "custom_annotations": [
                "@Service",
                "@Autowired"
              ],
              "custom_classes": [
                "Service",
                "Autowired",
                "DataSource",
                "User",
                "Connection",
                "INSERT",
                "PreparedStatement"
              ],
              "framework_apis": [
                "Spring IoC Container",
                "Spring Data Access",
                "JDBC Template",
                "Spring Bean Management"
              ]
            }
          },
          "validation_info": {
            "reviewed_by": "system_generated",
            "review_date": "2025-09-30",
            "validation_status": "DRAFT",
            "quality_score": 0.9
          }
        },
        "type": "anti_pattern"
      },
      "fixSuggestion": {
        "steps": [
          "try-with-resources 구문을 사용하여 Connection 객체를 자동으로 관리하도록 수정",
          "PreparedStatement도 try-with-resources에 포함하여 완전한 리소스 관리 구현",
          "예외 발생 시에도 리소스가 자동으로 해제되도록 보장"
        ],
        "fixedCode": "public void deleteUser(String userId) throws SQLException {\n    try (Connection conn = dataSource.getConnection();\n         PreparedStatement pstmt = conn.prepareStatement(\"DELETE FROM users WHERE user_id = ?\")) {\n        \n        pstmt.setString(1, userId);\n        pstmt.executeUpdate();\n        \n    } // Connection과 PreparedStatement가 자동으로 close됨\n}",
        "explanation": "기존 코드는 Connection 객체를 생성한 후 명시적으로 close()하지 않아 리소스 누수가 발생할 위험이 있습니다. try-with-resources 구문을 사용하면 AutoCloseable 인터페이스를 구현한 리소스들이 try 블록을 벗어날 때 자동으로 close() 메서드가 호출됩니다. 이는 정상적인 실행뿐만 아니라 예외가 발생한 경우에도 보장되므로, 데이터베이스 커넥션 풀의 고갈을 방지하고 시스템의 안정성을 크게 향상시킵니다. 또한 PreparedStatement도 함께 관리하여 완전한 리소스 관리를 구현했습니다.",
        "confidence": 0.95,
        "patternBasedSuggestions": [
          "리소스 자동 관리 구현",
          "try-with-resources 사용"
        ],
        "codeExample": "// 패턴 정보 없음",
        "frameworkNotes": []
      }
    },
    {
      "id": "issue_4",
      "title": "데이터베이스 커넥션 누수로 인한 서비스 장애",
      "description": "Database Connection이 닫히지 않아 리소스 누수 위험",
      "severity": "MEDIUM",
      "category": "resource_management",
      "location": {
        "startLine": 81,
        "endLine": 81,
        "startColumn": 0,
        "endColumn": 0
      },
      "codeSnippet": "    public void processAllUsers() throws SQLException {\n        Connection conn = dataSource.getConnection();\n        PreparedStatement stmt = conn.prepareStatement(\"SELECT id FROM users\");",
      "patternInfo": {
        "confidence": 0.9
      },
      "relatedPattern": {
        "id": "RESOURCE_227296_677",
        "title": "데이터베이스 커넥션 누수로 인한 서비스 장애",
        "category": "resource_management",
        "severity": "HIGH",
        "semanticSignature": "unclosed_database_connection",
        "astSignature": "{\"structural\":{\"nodePattern\":\"ClassDeclaration->MethodDeclaration->VariableDeclaration->VariableDeclaration->VariableDeclaration\",\"depthPattern\":2,\"complexityPattern\":1},\"semantic\":{\"resourcePattern\":\"Connection:undefined,PreparedStatement:undefined,Statement:undefined\",\"securityPattern\":\"sql_injection\",\"frameworkPattern\":\"@Service,@Autowired\"},\"behavioral\":{\"methodCallPattern\":\"dataSource.getConnection->conn.prepareStatement->stmt.executeUpdate->conn.close\",\"controlFlowPattern\":\"\",\"exceptionPattern\":\"\"}}",
        "cyclomaticComplexity": 1,
        "maxDepth": 2,
        "qualityScore": 0.9,
        "fullData": {
          "issue_record_id": "RESOURCE_227296_677",
          "metadata": {
            "title": "데이터베이스 커넥션 누수로 인한 서비스 장애",
            "category": "resource_management",
            "severity": "HIGH",
            "tags": [
              "커넥션풀",
              "리소스누수",
              "데이터베이스",
              "메모리누수"
            ],
            "created_date": "2024-01-15T09:30:00Z",
            "last_updated": "2025-09-30T07:10:27.296Z"
          },
          "anti_pattern": {
            "code_template": "Connection conn = dataSource.getConnection();\n// 데이터베이스 작업 수행\n// conn.close() 누락",
            "pattern_signature": {
              "semantic_signature": "unclosed_database_connection",
              "regex_patterns": [
                "Connection\\s+\\w+\\s*=\\s*.*\\.getConnection\\(\\)",
                "(?!.*close\\(\\)).*getConnection\\(\\).*"
              ]
            },
            "problematic_characteristics": {
              "missing_operations": [
                "커넥션 자원 해제",
                "예외 상황에서의 리소스 정리"
              ],
              "incorrect_usage": [
                "수동 커넥션 관리",
                "SQL 인젝션 취약한 문자열 연결"
              ],
              "framework_violations": [
                "Spring 트랜잭션 관리 미사용",
                "try-with-resources 패턴 미적용"
              ]
            }
          },
          "recommended_pattern": {
            "code_template": "try (Connection conn = dataSource.getConnection()) {\n    // 데이터베이스 작업 수행\n    // 자동으로 리소스 해제됨\n}",
            "pattern_name": "try_with_resources_pattern",
            "implementation_guide": {
              "best_practices": [
                "try-with-resources 구문 사용",
                "PreparedStatement로 SQL 인젝션 방지",
                "Spring @Transactional 어노테이션 활용"
              ],
              "framework_specific_notes": [
                "Spring Boot에서는 JdbcTemplate 사용 권장",
                "커넥션 풀 설정 최적화 필요"
              ]
            }
          },
          "impact_analysis": {
            "production_impact": {
              "failure_scenarios": [
                "커넥션 풀 고갈로 인한 서비스 중단",
                "피크 시간대 응답 불가"
              ],
              "performance_degradation": {
                "response_time_impact": "커넥션 대기 시간 증가로 응답 시간이 기하급수적으로 증가",
                "throughput_impact": "동시 처리 가능한 요청 수가 커넥션 풀 크기로 제한되어 처리량 급감",
                "resource_consumption": "미해제된 커넥션이 메모리와 데이터베이스 리소스를 지속적으로 점유"
              }
            },
            "historical_data": {
              "occurrence_frequency": 15,
              "fix_effort_estimation": {
                "complexity": "LOW",
                "estimated_hours": 2,
                "required_expertise": [
                  "자바 개발자"
                ]
              }
            }
          },
          "embeddings": {
            "combined_embedding": [
              0.07989708780977135,
              0.07989708780977135,
              0.23969126342931404,
              0.07989708780977135,
              0.019974271952442838,
              0.019974271952442838,
              0.05992281585732851,
              0.07989708780977135,
              0,
              0,
              0,
              0,
              0,
              0.39948543904885675,
              0,
              0.39948543904885675,
              0,
              0,
              0.07989708780977135,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0.09987135976221419,
              0.09987135976221419,
              0,
              0,
              0.23969126342931404,
              0,
              0,
              0.39948543904885675,
              0.13316181301628557,
              0,
              0,
              0,
              0,
              0,
              0.019974271952442838,
              0.07989708780977135,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0.39948543904885675,
              0,
              0,
              0.39948543904885675,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0.07989708780977135,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0
            ],
            "component_embeddings": {
              "syntactic_embedding": [
                0.2,
                0.2,
                0.6,
                0.2,
                0.05,
                0.05,
                0.15,
                0.2,
                0,
                0,
                0,
                0,
                0,
                1,
                0,
                1,
                0,
                0,
                0.2,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0
              ],
              "semantic_embedding": [
                0.25,
                0.25,
                0,
                0,
                0.6,
                0,
                0,
                1,
                0.3333333333333333,
                0,
                0,
                0,
                0,
                0,
                0.05,
                0.2,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0
              ],
              "framework_embedding": [
                0,
                1,
                0,
                0,
                1,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0
              ],
              "context_embedding": [
                0.2,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0
              ]
            },
            "embedding_metadata": {
              "embedding_version": "v1.0",
              "created_timestamp": "2025-09-30T07:10:27.295Z",
              "model_version": "CustomEmbedding-1.0.0"
            },
            "ast_analysis": {
              "success": true,
              "nodeTypes": [
                "ClassDeclaration",
                "MethodDeclaration",
                "VariableDeclaration",
                "VariableDeclaration",
                "VariableDeclaration"
              ],
              "cyclomaticComplexity": 1,
              "maxDepth": 2,
              "signature": "{\"structural\":{\"nodePattern\":\"ClassDeclaration->MethodDeclaration->VariableDeclaration->VariableDeclaration->VariableDeclaration\",\"depthPattern\":2,\"complexityPattern\":1},\"semantic\":{\"resourcePattern\":\"Connection:undefined,PreparedStatement:undefined,Statement:undefined\",\"securityPattern\":\"sql_injection\",\"frameworkPattern\":\"@Service,@Autowired\"},\"behavioral\":{\"methodCallPattern\":\"dataSource.getConnection->conn.prepareStatement->stmt.executeUpdate->conn.close\",\"controlFlowPattern\":\"\",\"exceptionPattern\":\"\"}}",
              "resourceLeakRisks": [],
              "securityPatterns": [
                {
                  "type": "sql_injection",
                  "description": "String concatenation in SQL query",
                  "severity": "HIGH"
                }
              ],
              "performanceIssues": [],
              "methodDeclarations": [
                {
                  "returnType": "User",
                  "name": "createUser",
                  "parameters": "String name, String email"
                },
                {
                  "returnType": "INTO",
                  "name": "users",
                  "parameters": "name, email"
                },
                {
                  "returnType": "return",
                  "name": "findUserByName",
                  "parameters": "name"
                }
              ],
              "classDeclarations": [
                {
                  "name": "UserService",
                  "extends": null,
                  "implements": []
                }
              ]
            }
          },
          "related_patterns": [],
          "detection_rules": {
            "ast_rules": [
              {
                "rule_name": "spring_service_annotation_detection",
                "rule_expression": "AnnotationExpr[@Service] && ClassOrInterfaceDeclaration",
                "confidence_score": 0.9
              },
              {
                "rule_name": "dependency_injection_pattern",
                "rule_expression": "FieldDeclaration[AnnotationExpr[@Autowired]]",
                "confidence_score": 0.85
              },
              {
                "rule_name": "jdbc_database_operation",
                "rule_expression": "MethodCallExpr[PreparedStatement] && VariableDeclarator[DataSource|Connection]",
                "confidence_score": 0.8
              }
            ],
            "semantic_rules": [
              {
                "rule_name": "spring_service_layer_pattern",
                "rule_description": "Spring Framework의 서비스 계층 패턴으로 비즈니스 로직을 담당하는 컴포넌트를 식별",
                "pattern_indicators": [
                  "@Service",
                  "Service",
                  "비즈니스 로직 처리"
                ]
              },
              {
                "rule_name": "spring_dependency_injection",
                "rule_description": "Spring의 의존성 주입 패턴으로 객체 간의 의존관계를 자동으로 설정",
                "pattern_indicators": [
                  "@Autowired",
                  "의존성 주입",
                  "IoC 컨테이너"
                ]
              },
              {
                "rule_name": "jdbc_data_access_pattern",
                "rule_description": "JDBC를 사용한 데이터베이스 접근 패턴으로 SQL 쿼리 실행 및 데이터 조작",
                "pattern_indicators": [
                  "DataSource",
                  "Connection",
                  "PreparedStatement",
                  "INSERT",
                  "데이터베이스 연결"
                ]
              }
            ]
          },
          "framework_context": {
            "framework_version": "Spring_Framework_5.x_or_later",
            "applicable_components": {
              "custom_annotations": [
                "@Service",
                "@Autowired"
              ],
              "custom_classes": [
                "Service",
                "Autowired",
                "DataSource",
                "User",
                "Connection",
                "INSERT",
                "PreparedStatement"
              ],
              "framework_apis": [
                "Spring IoC Container",
                "Spring Data Access",
                "JDBC Template",
                "Spring Bean Management"
              ]
            }
          },
          "validation_info": {
            "reviewed_by": "system_generated",
            "review_date": "2025-09-30",
            "validation_status": "DRAFT",
            "quality_score": 0.9
          }
        },
        "type": "anti_pattern"
      },
      "fixSuggestion": {
        "steps": [
          "try-with-resources 구문을 사용하여 Connection과 PreparedStatement를 자동으로 관리하도록 수정",
          "리소스들을 try 블록의 괄호 안에서 선언하여 블록 종료 시 자동으로 close() 메서드가 호출되도록 구현"
        ],
        "fixedCode": "public void processAllUsers() throws SQLException {\n    try (Connection conn = dataSource.getConnection();\n         PreparedStatement stmt = conn.prepareStatement(\"SELECT id FROM users\")) {\n        \n        // 기존 비즈니스 로직 수행\n        ResultSet rs = stmt.executeQuery();\n        while (rs.next()) {\n            // 사용자 처리 로직\n        }\n    }\n}",
        "explanation": "try-with-resources 구문을 사용하면 AutoCloseable 인터페이스를 구현한 리소스들(Connection, PreparedStatement 등)이 try 블록이 끝날 때 자동으로 close() 메서드가 호출됩니다. 이는 예외가 발생하더라도 리소스가 확실히 해제되어 커넥션 풀 고갈이나 메모리 누수를 방지할 수 있습니다. 기존 코드에서는 예외 발생 시 리소스가 해제되지 않아 데이터베이스 커넥션이 누수될 위험이 있었지만, 수정된 코드는 JVM이 자동으로 리소스 정리를 보장합니다.",
        "confidence": 0.95,
        "patternBasedSuggestions": [
          "리소스 자동 관리 구현",
          "try-with-resources 사용"
        ],
        "codeExample": "// 패턴 정보 없음",
        "frameworkNotes": []
      }
    },
    {
      "id": "issue_5",
      "title": "데이터베이스 커넥션 누수로 인한 서비스 장애",
      "description": "Database Connection이 닫히지 않아 리소스 누수 위험",
      "severity": "MEDIUM",
      "category": "resource_management",
      "location": {
        "startLine": 94,
        "endLine": 94,
        "startColumn": 0,
        "endColumn": 0
      },
      "codeSnippet": "    private void processUserDetails(int userId) throws SQLException {\n        Connection conn = dataSource.getConnection();\n        PreparedStatement stmt = conn.prepareStatement(\"SELECT * FROM user_details WHERE user_id = ?\");",
      "patternInfo": {
        "confidence": 0.9
      },
      "relatedPattern": {
        "id": "RESOURCE_227296_677",
        "title": "데이터베이스 커넥션 누수로 인한 서비스 장애",
        "category": "resource_management",
        "severity": "HIGH",
        "semanticSignature": "unclosed_database_connection",
        "astSignature": "{\"structural\":{\"nodePattern\":\"ClassDeclaration->MethodDeclaration->VariableDeclaration->VariableDeclaration->VariableDeclaration\",\"depthPattern\":2,\"complexityPattern\":1},\"semantic\":{\"resourcePattern\":\"Connection:undefined,PreparedStatement:undefined,Statement:undefined\",\"securityPattern\":\"sql_injection\",\"frameworkPattern\":\"@Service,@Autowired\"},\"behavioral\":{\"methodCallPattern\":\"dataSource.getConnection->conn.prepareStatement->stmt.executeUpdate->conn.close\",\"controlFlowPattern\":\"\",\"exceptionPattern\":\"\"}}",
        "cyclomaticComplexity": 1,
        "maxDepth": 2,
        "qualityScore": 0.9,
        "fullData": {
          "issue_record_id": "RESOURCE_227296_677",
          "metadata": {
            "title": "데이터베이스 커넥션 누수로 인한 서비스 장애",
            "category": "resource_management",
            "severity": "HIGH",
            "tags": [
              "커넥션풀",
              "리소스누수",
              "데이터베이스",
              "메모리누수"
            ],
            "created_date": "2024-01-15T09:30:00Z",
            "last_updated": "2025-09-30T07:10:27.296Z"
          },
          "anti_pattern": {
            "code_template": "Connection conn = dataSource.getConnection();\n// 데이터베이스 작업 수행\n// conn.close() 누락",
            "pattern_signature": {
              "semantic_signature": "unclosed_database_connection",
              "regex_patterns": [
                "Connection\\s+\\w+\\s*=\\s*.*\\.getConnection\\(\\)",
                "(?!.*close\\(\\)).*getConnection\\(\\).*"
              ]
            },
            "problematic_characteristics": {
              "missing_operations": [
                "커넥션 자원 해제",
                "예외 상황에서의 리소스 정리"
              ],
              "incorrect_usage": [
                "수동 커넥션 관리",
                "SQL 인젝션 취약한 문자열 연결"
              ],
              "framework_violations": [
                "Spring 트랜잭션 관리 미사용",
                "try-with-resources 패턴 미적용"
              ]
            }
          },
          "recommended_pattern": {
            "code_template": "try (Connection conn = dataSource.getConnection()) {\n    // 데이터베이스 작업 수행\n    // 자동으로 리소스 해제됨\n}",
            "pattern_name": "try_with_resources_pattern",
            "implementation_guide": {
              "best_practices": [
                "try-with-resources 구문 사용",
                "PreparedStatement로 SQL 인젝션 방지",
                "Spring @Transactional 어노테이션 활용"
              ],
              "framework_specific_notes": [
                "Spring Boot에서는 JdbcTemplate 사용 권장",
                "커넥션 풀 설정 최적화 필요"
              ]
            }
          },
          "impact_analysis": {
            "production_impact": {
              "failure_scenarios": [
                "커넥션 풀 고갈로 인한 서비스 중단",
                "피크 시간대 응답 불가"
              ],
              "performance_degradation": {
                "response_time_impact": "커넥션 대기 시간 증가로 응답 시간이 기하급수적으로 증가",
                "throughput_impact": "동시 처리 가능한 요청 수가 커넥션 풀 크기로 제한되어 처리량 급감",
                "resource_consumption": "미해제된 커넥션이 메모리와 데이터베이스 리소스를 지속적으로 점유"
              }
            },
            "historical_data": {
              "occurrence_frequency": 15,
              "fix_effort_estimation": {
                "complexity": "LOW",
                "estimated_hours": 2,
                "required_expertise": [
                  "자바 개발자"
                ]
              }
            }
          },
          "embeddings": {
            "combined_embedding": [
              0.07989708780977135,
              0.07989708780977135,
              0.23969126342931404,
              0.07989708780977135,
              0.019974271952442838,
              0.019974271952442838,
              0.05992281585732851,
              0.07989708780977135,
              0,
              0,
              0,
              0,
              0,
              0.39948543904885675,
              0,
              0.39948543904885675,
              0,
              0,
              0.07989708780977135,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0.09987135976221419,
              0.09987135976221419,
              0,
              0,
              0.23969126342931404,
              0,
              0,
              0.39948543904885675,
              0.13316181301628557,
              0,
              0,
              0,
              0,
              0,
              0.019974271952442838,
              0.07989708780977135,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0.39948543904885675,
              0,
              0,
              0.39948543904885675,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0.07989708780977135,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0
            ],
            "component_embeddings": {
              "syntactic_embedding": [
                0.2,
                0.2,
                0.6,
                0.2,
                0.05,
                0.05,
                0.15,
                0.2,
                0,
                0,
                0,
                0,
                0,
                1,
                0,
                1,
                0,
                0,
                0.2,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0
              ],
              "semantic_embedding": [
                0.25,
                0.25,
                0,
                0,
                0.6,
                0,
                0,
                1,
                0.3333333333333333,
                0,
                0,
                0,
                0,
                0,
                0.05,
                0.2,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0
              ],
              "framework_embedding": [
                0,
                1,
                0,
                0,
                1,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0
              ],
              "context_embedding": [
                0.2,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0
              ]
            },
            "embedding_metadata": {
              "embedding_version": "v1.0",
              "created_timestamp": "2025-09-30T07:10:27.295Z",
              "model_version": "CustomEmbedding-1.0.0"
            },
            "ast_analysis": {
              "success": true,
              "nodeTypes": [
                "ClassDeclaration",
                "MethodDeclaration",
                "VariableDeclaration",
                "VariableDeclaration",
                "VariableDeclaration"
              ],
              "cyclomaticComplexity": 1,
              "maxDepth": 2,
              "signature": "{\"structural\":{\"nodePattern\":\"ClassDeclaration->MethodDeclaration->VariableDeclaration->VariableDeclaration->VariableDeclaration\",\"depthPattern\":2,\"complexityPattern\":1},\"semantic\":{\"resourcePattern\":\"Connection:undefined,PreparedStatement:undefined,Statement:undefined\",\"securityPattern\":\"sql_injection\",\"frameworkPattern\":\"@Service,@Autowired\"},\"behavioral\":{\"methodCallPattern\":\"dataSource.getConnection->conn.prepareStatement->stmt.executeUpdate->conn.close\",\"controlFlowPattern\":\"\",\"exceptionPattern\":\"\"}}",
              "resourceLeakRisks": [],
              "securityPatterns": [
                {
                  "type": "sql_injection",
                  "description": "String concatenation in SQL query",
                  "severity": "HIGH"
                }
              ],
              "performanceIssues": [],
              "methodDeclarations": [
                {
                  "returnType": "User",
                  "name": "createUser",
                  "parameters": "String name, String email"
                },
                {
                  "returnType": "INTO",
                  "name": "users",
                  "parameters": "name, email"
                },
                {
                  "returnType": "return",
                  "name": "findUserByName",
                  "parameters": "name"
                }
              ],
              "classDeclarations": [
                {
                  "name": "UserService",
                  "extends": null,
                  "implements": []
                }
              ]
            }
          },
          "related_patterns": [],
          "detection_rules": {
            "ast_rules": [
              {
                "rule_name": "spring_service_annotation_detection",
                "rule_expression": "AnnotationExpr[@Service] && ClassOrInterfaceDeclaration",
                "confidence_score": 0.9
              },
              {
                "rule_name": "dependency_injection_pattern",
                "rule_expression": "FieldDeclaration[AnnotationExpr[@Autowired]]",
                "confidence_score": 0.85
              },
              {
                "rule_name": "jdbc_database_operation",
                "rule_expression": "MethodCallExpr[PreparedStatement] && VariableDeclarator[DataSource|Connection]",
                "confidence_score": 0.8
              }
            ],
            "semantic_rules": [
              {
                "rule_name": "spring_service_layer_pattern",
                "rule_description": "Spring Framework의 서비스 계층 패턴으로 비즈니스 로직을 담당하는 컴포넌트를 식별",
                "pattern_indicators": [
                  "@Service",
                  "Service",
                  "비즈니스 로직 처리"
                ]
              },
              {
                "rule_name": "spring_dependency_injection",
                "rule_description": "Spring의 의존성 주입 패턴으로 객체 간의 의존관계를 자동으로 설정",
                "pattern_indicators": [
                  "@Autowired",
                  "의존성 주입",
                  "IoC 컨테이너"
                ]
              },
              {
                "rule_name": "jdbc_data_access_pattern",
                "rule_description": "JDBC를 사용한 데이터베이스 접근 패턴으로 SQL 쿼리 실행 및 데이터 조작",
                "pattern_indicators": [
                  "DataSource",
                  "Connection",
                  "PreparedStatement",
                  "INSERT",
                  "데이터베이스 연결"
                ]
              }
            ]
          },
          "framework_context": {
            "framework_version": "Spring_Framework_5.x_or_later",
            "applicable_components": {
              "custom_annotations": [
                "@Service",
                "@Autowired"
              ],
              "custom_classes": [
                "Service",
                "Autowired",
                "DataSource",
                "User",
                "Connection",
                "INSERT",
                "PreparedStatement"
              ],
              "framework_apis": [
                "Spring IoC Container",
                "Spring Data Access",
                "JDBC Template",
                "Spring Bean Management"
              ]
            }
          },
          "validation_info": {
            "reviewed_by": "system_generated",
            "review_date": "2025-09-30",
            "validation_status": "DRAFT",
            "quality_score": 0.9
          }
        },
        "type": "anti_pattern"
      },
      "fixSuggestion": {
        "steps": [
          "try-with-resources 구문을 사용하여 Connection과 PreparedStatement를 자동으로 관리하도록 수정",
          "리소스들을 try 블록의 괄호 안에 선언하여 블록 종료 시 자동으로 close()가 호출되도록 구현"
        ],
        "fixedCode": "private void processUserDetails(int userId) throws SQLException {\n    try (Connection conn = dataSource.getConnection();\n         PreparedStatement stmt = conn.prepareStatement(\"SELECT * FROM user_details WHERE user_id = ?\")) {\n        \n        stmt.setInt(1, userId);\n        try (ResultSet rs = stmt.executeQuery()) {\n            // 결과 처리 로직\n            while (rs.next()) {\n                // 데이터 처리\n            }\n        }\n    }\n}",
        "explanation": "기존 코드는 Connection과 PreparedStatement가 명시적으로 닫히지 않아 리소스 누수가 발생할 위험이 있습니다. try-with-resources 구문을 사용하면 AutoCloseable 인터페이스를 구현한 리소스들이 try 블록을 벗어날 때 자동으로 close() 메서드가 호출됩니다. 이는 예외가 발생하더라도 리소스가 안전하게 해제됨을 보장합니다. Connection, PreparedStatement, ResultSet 모두 AutoCloseable을 구현하므로 이 패턴을 적용할 수 있으며, 수동으로 finally 블록에서 null 체크와 함께 close()를 호출하는 번거로움을 없애고 코드의 안전성을 크게 향상시킵니다.",
        "confidence": 0.95,
        "patternBasedSuggestions": [
          "리소스 자동 관리 구현",
          "try-with-resources 사용"
        ],
        "codeExample": "// 패턴 정보 없음",
        "frameworkNotes": []
      }
    },
    {
      "id": "issue_1",
      "title": "결제 처리 중 예외 처리 누락으로 인한 데이터 일관성 문제",
      "description": "printStackTrace() 사용으로 부적절한 예외 처리",
      "severity": "MEDIUM",
      "category": "exception_handling",
      "location": {
        "startLine": 55,
        "endLine": 55,
        "startColumn": 0,
        "endColumn": 0
      },
      "codeSnippet": "        } catch (SQLException e) {\n            e.printStackTrace();\n            // Poor error handling",
      "patternInfo": {
        "confidence": 0.8
      },
      "relatedPattern": {
        "id": "EXCEPTION_412328_592",
        "title": "결제 처리 중 예외 처리 누락으로 인한 데이터 일관성 문제",
        "category": "exception_handling",
        "severity": "HIGH",
        "semanticSignature": "unhandled_external_service_call",
        "astSignature": "{\"structural\":{\"nodePattern\":\"ClassDeclaration->MethodDeclaration->MethodDeclaration->VariableDeclaration->VariableDeclaration\",\"depthPattern\":2,\"complexityPattern\":1},\"semantic\":{\"resourcePattern\":\"\",\"securityPattern\":\"\",\"frameworkPattern\":\"@Service,@Autowired,@Autowired\"},\"behavioral\":{\"methodCallPattern\":\"orderService.findById->request.getOrderId->order.setStatus->orderService.save->paymentGateway.charge\",\"controlFlowPattern\":\"\",\"exceptionPattern\":\"\"}}",
        "cyclomaticComplexity": 1,
        "maxDepth": 2,
        "qualityScore": 0.9,
        "fullData": {
          "issue_record_id": "EXCEPTION_412328_592",
          "metadata": {
            "title": "결제 처리 중 예외 처리 누락으로 인한 데이터 일관성 문제",
            "category": "exception_handling",
            "severity": "HIGH",
            "tags": [
              "예외처리",
              "결제시스템",
              "트랜잭션",
              "데이터일관성"
            ],
            "created_date": "2024-02-25T10:30:00Z",
            "last_updated": "2025-09-30T07:13:32.328Z"
          },
          "anti_pattern": {
            "code_template": "public void processPayment(PaymentRequest request) {\n    Order order = orderService.findById(request.getOrderId());\n    order.setStatus(\"PROCESSING\");\n    orderService.save(order);\n    \n    PaymentResponse response = paymentGateway.charge(request); // 예외 처리 없음\n    \n    order.setStatus(\"PAID\");\n    orderService.save(order);\n}",
            "pattern_signature": {
              "semantic_signature": "unhandled_external_service_call",
              "regex_patterns": [
                "\\w+\\.charge\\([^)]+\\)\\s*;(?!.*catch)",
                "paymentGateway\\.[\\w]+\\([^)]*\\)(?!.*try.*catch)"
              ]
            },
            "problematic_characteristics": {
              "missing_operations": [
                "외부 서비스 호출 예외 처리",
                "트랜잭션 롤백 처리",
                "실패 상태 업데이트"
              ],
              "incorrect_usage": [
                "예외 발생 시 주문 상태 불일치",
                "부분적 데이터 업데이트",
                "트랜잭션 경계 미설정"
              ],
              "framework_violations": [
                "@Transactional 어노테이션 누락",
                "Spring 예외 처리 패턴 미준수",
                "서비스 레이어 예외 전파 규칙 위반"
              ]
            }
          },
          "recommended_pattern": {
            "code_template": "@Transactional\npublic void processPayment(PaymentRequest request) {\n    Order order = orderService.findById(request.getOrderId());\n    order.setStatus(\"PROCESSING\");\n    orderService.save(order);\n    \n    try {\n        PaymentResponse response = paymentGateway.charge(request);\n        order.setStatus(\"PAID\");\n        order.setPaymentId(response.getPaymentId());\n        orderService.save(order);\n    } catch (PaymentGatewayException e) {\n        order.setStatus(\"PAYMENT_FAILED\");\n        orderService.save(order);\n        throw new PaymentProcessingException(\"Payment failed\", e);\n    }\n}",
            "pattern_name": "transactional_exception_handling_pattern",
            "implementation_guide": {
              "best_practices": [
                "외부 서비스 호출을 try-catch로 감싸기",
                "@Transactional 어노테이션으로 트랜잭션 경계 설정",
                "예외 발생 시 적절한 상태로 업데이트",
                "비즈니스 예외를 명확히 정의하여 던지기"
              ],
              "framework_specific_notes": [
                "Spring @Transactional은 런타임 예외에서만 롤백됨",
                "체크드 예외의 경우 rollbackFor 속성 명시 필요",
                "프록시 기반이므로 같은 클래스 내부 호출 시 트랜잭션 적용 안됨",
                "PaymentGatewayException을 커스텀 예외로 정의하여 명확한 예외 처리"
              ]
            }
          },
          "impact_analysis": {
            "production_impact": {
              "failure_scenarios": [
                "결제 게이트웨이 장애 시 주문 상태가 PROCESSING으로 남아있음",
                "네트워크 타임아웃 발생 시 결제 성공 여부 불명",
                "부분적 데이터 업데이트로 인한 데이터 불일치"
              ],
              "performance_degradation": {
                "response_time_impact": "예외 발생 시 적절한 처리가 없어 클라이언트가 무한 대기하거나 타임아웃까지 기다려야 함",
                "throughput_impact": "실패한 결제 요청이 재시도되면서 시스템 전체 처리량이 감소하고 리소스 낭비 발생",
                "resource_consumption": "예외 처리 없이 실패한 트랜잭션이 데이터베이스 커넥션을 점유하여 커넥션 풀 고갈 위험"
              }
            },
            "historical_data": {
              "occurrence_frequency": 18,
              "fix_effort_estimation": {
                "complexity": "LOW",
                "estimated_hours": 2,
                "required_expertise": [
                  "자바 개발자"
                ]
              }
            }
          },
          "embeddings": {
            "combined_embedding": [
              0.08468572427517379,
              0.16937144855034758,
              0.16937144855034758,
              0.08468572427517379,
              0.021171431068793448,
              0.021171431068793448,
              0.042342862137586895,
              0.08468572427517379,
              0,
              0,
              0,
              0,
              0,
              0.4234286213758689,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0.4234286213758689,
              0,
              0,
              0,
              0,
              0,
              0,
              0.021171431068793448,
              0.08468572427517379,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0.4234286213758689,
              0,
              0,
              0.4234286213758689,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0.08468572427517379,
              0.08468572427517379,
              0,
              0,
              0.4234286213758689,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0,
              0
            ],
            "component_embeddings": {
              "syntactic_embedding": [
                0.2,
                0.4,
                0.4,
                0.2,
                0.05,
                0.05,
                0.1,
                0.2,
                0,
                0,
                0,
                0,
                0,
                1,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0
              ],
              "semantic_embedding": [
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                1,
                0,
                0,
                0,
                0,
                0,
                0,
                0.05,
                0.2,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0
              ],
              "framework_embedding": [
                0,
                1,
                0,
                0,
                1,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0
              ],
              "context_embedding": [
                0,
                0.2,
                0.2,
                0,
                0,
                1,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0,
                0
              ]
            },
            "embedding_metadata": {
              "embedding_version": "v1.0",
              "created_timestamp": "2025-09-30T07:13:32.328Z",
              "model_version": "CustomEmbedding-1.0.0"
            },
            "ast_analysis": {
              "success": true,
              "nodeTypes": [
                "ClassDeclaration",
                "MethodDeclaration",
                "MethodDeclaration",
                "VariableDeclaration",
                "VariableDeclaration"
              ],
              "cyclomaticComplexity": 1,
              "maxDepth": 2,
              "signature": "{\"structural\":{\"nodePattern\":\"ClassDeclaration->MethodDeclaration->MethodDeclaration->VariableDeclaration->VariableDeclaration\",\"depthPattern\":2,\"complexityPattern\":1},\"semantic\":{\"resourcePattern\":\"\",\"securityPattern\":\"\",\"frameworkPattern\":\"@Service,@Autowired,@Autowired\"},\"behavioral\":{\"methodCallPattern\":\"orderService.findById->request.getOrderId->order.setStatus->orderService.save->paymentGateway.charge\",\"controlFlowPattern\":\"\",\"exceptionPattern\":\"\"}}",
              "resourceLeakRisks": [],
              "securityPatterns": [],
              "performanceIssues": [],
              "methodDeclarations": [
                {
                  "returnType": "void",
                  "name": "processPayment",
                  "parameters": "PaymentRequest request"
                },
                {
                  "returnType": "void",
                  "name": "sendConfirmationEmail",
                  "parameters": "Order order"
                }
              ],
              "classDeclarations": [
                {
                  "name": "PaymentService",
                  "extends": null,
                  "implements": []
                }
              ]
            }
          },
          "related_patterns": [],
          "detection_rules": {
            "ast_rules": [
              {
                "rule_name": "spring_service_annotation_detection",
                "rule_expression": "AnnotationExpr[@name='Service'] && ClassOrInterfaceDeclaration",
                "confidence_score": 0.9
              },
              {
                "rule_name": "dependency_injection_pattern",
                "rule_expression": "FieldDeclaration[AnnotationExpr[@name='Autowired']] || MethodDeclaration[AnnotationExpr[@name='Autowired']]",
                "confidence_score": 0.85
              },
              {
                "rule_name": "payment_service_class_structure",
                "rule_expression": "ClassOrInterfaceDeclaration[@name contains 'Service'] && MethodDeclaration[@name contains 'payment' || @name contains 'order']",
                "confidence_score": 0.8
              }
            ],
            "semantic_rules": [
              {
                "rule_name": "spring_framework_service_layer_pattern",
                "rule_description": "Spring Framework의 서비스 계층 패턴으로 @Service 어노테이션과 @Autowired를 통한 의존성 주입을 사용하는 구조",
                "pattern_indicators": [
                  "@Service 어노테이션 사용",
                  "@Autowired 의존성 주입",
                  "Service 접미사 클래스명",
                  "비즈니스 로직 처리 계층"
                ]
              },
              {
                "rule_name": "payment_processing_domain_pattern",
                "rule_description": "결제 처리 도메인 패턴으로 주문 서비스와 외부 결제 게이트웨이 연동을 포함하는 전자상거래 시스템 구조",
                "pattern_indicators": [
                  "PaymentRequest/PaymentResponse DTO 패턴",
                  "ExternalPaymentGateway 외부 연동",
                  "OrderService 주문 처리",
                  "Order 도메인 엔티티"
                ]
              }
            ]
          },
          "framework_context": {
            "framework_version": "Spring Framework 5.x 또는 Spring Boot 2.x",
            "applicable_components": {
              "custom_annotations": [
                "@Service",
                "@Autowired"
              ],
              "custom_classes": [
                "Service",
                "Autowired",
                "ExternalPaymentGateway",
                "OrderService",
                "PaymentRequest",
                "Order",
                "PaymentResponse"
              ],
              "framework_apis": [
                "org.springframework.stereotype.Service",
                "org.springframework.beans.factory.annotation.Autowired",
                "org.springframework.context.ApplicationContext",
                "org.springframework.transaction.annotation.Transactional"
              ]
            }
          },
          "validation_info": {
            "reviewed_by": "system_generated",
            "review_date": "2025-09-30",
            "validation_status": "DRAFT",
            "quality_score": 0.9
          }
        },
        "type": "anti_pattern"
      },
      "fixSuggestion": {
        "steps": [
          "printStackTrace() 호출을 제거하고 적절한 로깅 프레임워크(SLF4J/Logback)를 사용하여 예외 정보를 기록",
          "데이터 일관성을 위해 트랜잭션 롤백 처리를 추가하고, 비즈니스 로직에 맞는 커스텀 예외로 래핑하여 상위 레이어로 전파"
        ],
        "fixedCode": "        } catch (SQLException e) {\n            logger.error(\"결제 처리 중 데이터베이스 오류 발생: {}\", e.getMessage(), e);\n            \n            // 트랜잭션 롤백 처리\n            try {\n                if (connection != null && !connection.getAutoCommit()) {\n                    connection.rollback();\n                }\n            } catch (SQLException rollbackEx) {\n                logger.error(\"트랜잭션 롤백 실패: {}\", rollbackEx.getMessage(), rollbackEx);\n            }\n            \n            // 비즈니스 예외로 래핑하여 전파\n            throw new PaymentProcessingException(\"결제 처리에 실패했습니다.\", e);\n        }",
        "explanation": "기존 코드의 printStackTrace()는 운영 환경에서 부적절하며 데이터 일관성 문제를 야기할 수 있습니다. 수정된 코드는 1) 구조화된 로깅을 통해 예외 정보를 적절히 기록하고, 2) 트랜잭션 롤백을 통해 데이터 일관성을 보장하며, 3) 커스텀 예외로 래핑하여 상위 레이어에서 적절한 처리가 가능하도록 합니다. 이를 통해 결제 처리 실패 시에도 시스템의 안정성과 데이터 무결성을 유지할 수 있습니다.",
        "confidence": 0.92,
        "patternBasedSuggestions": [
          "적절한 로깅",
          "예외 전파"
        ],
        "codeExample": "// 패턴 정보 없음",
        "frameworkNotes": []
      }
    }
  ],
  "recommendations": [
    {
      "category": "exception_handling",
      "implemented": [],
      "missing": [
        "적절한 로깅",
        "예외 전파"
      ],
      "suggestions": [
        "적절한 로깅",
        "예외 전파"
      ],
      "codeExample": "// 패턴 정보 없음",
      "frameworkNotes": []
    },
    {
      "category": "resource_management",
      "implemented": [],
      "missing": [
        "리소스 자동 관리 구현",
        "try-with-resources 사용"
      ],
      "suggestions": [
        "리소스 자동 관리 구현",
        "try-with-resources 사용"
      ],
      "codeExample": "// 패턴 정보 없음",
      "frameworkNotes": []
    },
    {
      "category": "security_vulnerability",
      "implemented": [],
      "missing": [
        "입력값 검증",
        "파라미터화된 쿼리 사용"
      ],
      "suggestions": [
        "입력값 검증",
        "파라미터화된 쿼리 사용"
      ],
      "codeExample": "// 패턴 정보 없음",
      "frameworkNotes": []
    },
    {
      "category": "performance_issue",
      "implemented": [],
      "missing": [
        "쿼리 최적화",
        "배치 처리 고려"
      ],
      "suggestions": [
        "쿼리 최적화",
        "배치 처리 고려"
      ],
      "codeExample": "// 패턴 정보 없음",
      "frameworkNotes": []
    }
  ],
  "vectorDbBasedFixes": [
    {
      "issueTitle": "SQL 인젝션 취약점 - 문자열 연결을 통한 동적 쿼리 생성",
      "patternBasedSuggestions": [
        "입력값 검증",
        "파라미터화된 쿼리 사용"
      ],
      "frameworkNotes": [],
      "codeExample": "// 패턴 정보 없음"
    },
    {
      "issueTitle": "데이터베이스 커넥션 누수로 인한 서비스 장애",
      "patternBasedSuggestions": [
        "리소스 자동 관리 구현",
        "try-with-resources 사용"
      ],
      "frameworkNotes": [],
      "codeExample": "// 패턴 정보 없음"
    },
    {
      "issueTitle": "데이터베이스 커넥션 누수로 인한 서비스 장애",
      "patternBasedSuggestions": [
        "리소스 자동 관리 구현",
        "try-with-resources 사용"
      ],
      "frameworkNotes": [],
      "codeExample": "// 패턴 정보 없음"
    },
    {
      "issueTitle": "데이터베이스 커넥션 누수로 인한 서비스 장애",
      "patternBasedSuggestions": [
        "리소스 자동 관리 구현",
        "try-with-resources 사용"
      ],
      "frameworkNotes": [],
      "codeExample": "// 패턴 정보 없음"
    },
    {
      "issueTitle": "데이터베이스 커넥션 누수로 인한 서비스 장애",
      "patternBasedSuggestions": [
        "리소스 자동 관리 구현",
        "try-with-resources 사용"
      ],
      "frameworkNotes": [],
      "codeExample": "// 패턴 정보 없음"
    },
    {
      "issueTitle": "결제 처리 중 예외 처리 누락으로 인한 데이터 일관성 문제",
      "patternBasedSuggestions": [
        "적절한 로깅",
        "예외 전파"
      ],
      "frameworkNotes": [],
      "codeExample": "// 패턴 정보 없음"
    }
  ],
  "fullFixedCode": "package com.example.service;\n\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.stereotype.Service;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport javax.sql.DataSource;\nimport java.sql.Connection;\nimport java.sql.PreparedStatement;\nimport java.sql.ResultSet;\nimport java.sql.SQLException;\n\n/**\n * UserService with proper resource management and security fixes\n * All database connection leaks and security vulnerabilities have been resolved\n */\n@Service\npublic class UserService {\n    \n    private static final Logger logger = LoggerFactory.getLogger(UserService.class);\n    \n    @Autowired\n    private DataSource dataSource;\n    \n    /**\n     * Creates a new user in the database\n     * Fixed: Proper resource management using try-with-resources\n     * Fixed: Enhanced exception handling with logging\n     */\n    public void createUser(String username, String email) throws SQLException {\n        // VectorDB 권장사항 적용: 입력값 검증\n        if (username == null || username.trim().isEmpty()) {\n            throw new IllegalArgumentException(\"Username cannot be null or empty\");\n        }\n        if (email == null || email.trim().isEmpty()) {\n            throw new IllegalArgumentException(\"Email cannot be null or empty\");\n        }\n        \n        String sql = \"INSERT INTO users (username, email) VALUES (?, ?)\";\n        \n        // VectorDB 권장사항 적용: try-with-resources로 리소스 자동 관리\n        try (Connection conn = dataSource.getConnection();\n             PreparedStatement stmt = conn.prepareStatement(sql)) {\n            \n            // VectorDB 권장사항 적용: 파라미터화된 쿼리 사용\n            stmt.setString(1, username);\n            stmt.setString(2, email);\n            \n            int result = stmt.executeUpdate();\n            \n            // VectorDB 권장사항 적용: 적절한 로깅\n            logger.info(\"User created successfully: username={}, result={}\", username, result);\n            System.out.println(\"User created: \" + result);\n            \n        } catch (SQLException e) {\n            // VectorDB 권장사항 적용: 적절한 로깅과 예외 전파\n            logger.error(\"Failed to create user: username={}, email={}\", username, email, e);\n            throw e; // 예외 전파\n        }\n    }\n    \n    /**\n     * Gets the total count of users\n     * Fixed: Proper resource management and exception handling\n     */\n    public int getUserCount() {\n        String sql = \"SELECT COUNT(*) FROM users\";\n        \n        // VectorDB 권장사항 적용: try-with-resources로 리소스 자동 관리\n        try (Connection conn = dataSource.getConnection();\n             PreparedStatement stmt = conn.prepareStatement(sql);\n             ResultSet rs = stmt.executeQuery()) {\n            \n            if (rs.next()) {\n                int count = rs.getInt(1);\n                logger.debug(\"User count retrieved: {}\", count);\n                return count;\n            }\n            \n        } catch (SQLException e) {\n            // VectorDB 권장사항 적용: 적절한 로깅\n            logger.error(\"Failed to get user count\", e);\n            // 예외를 런타임 예외로 래핑하여 호출자에게 전파\n            throw new RuntimeException(\"Failed to retrieve user count\", e);\n        }\n        \n        return 0;\n    }\n    \n    /**\n     * Deletes a user by ID\n     * Fixed: SQL injection vulnerability resolved with parameterized query\n     * Fixed: Proper resource management and input validation\n     */\n    public void deleteUser(String userId) throws SQLException {\n        // VectorDB 권장사항 적용: 입력값 검증\n        if (userId == null || userId.trim().isEmpty()) {\n            throw new IllegalArgumentException(\"User ID cannot be null or empty\");\n        }\n        \n        // 숫자 형식 검증\n        try {\n            Integer.parseInt(userId);\n        } catch (NumberFormatException e) {\n            throw new IllegalArgumentException(\"User ID must be a valid number\", e);\n        }\n        \n        // VectorDB 권장사항 적용: 파라미터화된 쿼리로 SQL 인젝션 방지\n        String sql = \"DELETE FROM users WHERE id = ?\";\n        \n        // VectorDB 권장사항 적용: try-with-resources로 리소스 자동 관리\n        try (Connection conn = dataSource.getConnection();\n             PreparedStatement stmt = conn.prepareStatement(sql)) {\n            \n            stmt.setInt(1, Integer.parseInt(userId));\n            int deletedRows = stmt.executeUpdate();\n            \n            // VectorDB 권장사항 적용: 적절한 로깅\n            logger.info(\"User deleted: userId={}, deletedRows={}\", userId, deletedRows);\n            \n        } catch (SQLException e) {\n            // VectorDB 권장사항 적용: 적절한 로깅과 예외 전파\n            logger.error(\"Failed to delete user: userId={}\", userId, e);\n            throw e;\n        }\n    }\n    \n    /**\n     * Processes all users efficiently\n     * Fixed: N+1 query problem resolved with JOIN query\n     * Fixed: Proper resource management\n     */\n    public void processAllUsers() throws SQLException {\n        // N+1 문제 해결: JOIN을 사용하여 한 번의 쿼리로 모든 데이터 조회\n        String sql = \"\"\"\n            SELECT u.id, u.username, u.email, ud.* \n            FROM users u \n            LEFT JOIN user_details ud ON u.id = ud.user_id\n            \"\"\";\n        \n        // VectorDB 권장사항 적용: try-with-resources로 리소스 자동 관리\n        try (Connection conn = dataSource.getConnection();\n             PreparedStatement stmt = conn.prepareStatement(sql);\n             ResultSet rs = stmt.executeQuery()) {\n            \n            int processedCount = 0;\n            while (rs.next()) {\n                int userId = rs.getInt(\"id\");\n                String username = rs.getString(\"username\");\n                String email = rs.getString(\"email\");\n                \n                // 사용자 세부 정보 처리 (별도 쿼리 없이)\n                processUserDetailsFromResultSet(userId, username, email, rs);\n                processedCount++;\n            }\n            \n            // VectorDB 권장사항 적용: 적절한 로깅\n            logger.info(\"Processed {} users successfully\", processedCount);\n            \n        } catch (SQLException e) {\n            // VectorDB 권장사항 적용: 적절한 로깅과 예외 전파\n            logger.error(\"Failed to process all users\", e);\n            throw e;\n        }\n    }\n    \n    /**\n     * Processes individual user details (legacy method for backward compatibility)\n     * Fixed: Proper resource management\n     */\n    private void processUserDetails(int userId) throws SQLException {\n        String sql = \"SELECT * FROM user_details WHERE user_id = ?\";\n        \n        // VectorDB 권장사항 적용: try-with-resources로 리소스 자동 관리\n        try (Connection conn = dataSource.getConnection();\n             PreparedStatement stmt = conn.prepareStatement(sql)) {\n            \n            stmt.setInt(1, userId);\n            \n            try (ResultSet rs = stmt.executeQuery()) {\n                if (rs.next()) {\n                    // Process user details\n                    logger.debug(\"Processing user details: userId={}\", userId);\n                    System.out.println(\"Processing user: \" + userId);\n                }\n            }\n            \n        } catch (SQLException e) {\n            // VectorDB 권장사항 적용: 적절한 로깅과 예외 전파\n            logger.error(\"Failed to process user details: userId={}\", userId, e);\n            throw e;\n        }\n    }\n    \n    /**\n     * Processes user details from existing ResultSet (optimized version)\n     * 새로운 메서드: N+1 문제 해결을 위해 추가\n     */\n    private void processUserDetailsFromResultSet(int userId, String username, String email, ResultSet rs) throws SQLException {\n        try {\n            // ResultSet에서 user_details 컬럼들을 직접 처리\n            // 이미 JOIN으로 가져온 데이터를 사용하므로 추가 쿼리 불필요\n            logger.debug(\"Processing user from joined result: userId={}, username={}, email={}\", userId, username, email);\n            System.out.println(\"Processing user: \" + userId + \" (\" + username + \")\");\n            \n        } catch (Exception e) {\n            // VectorDB 권장사항 적용: 적절한 로깅\n            logger.error(\"Failed to process user details from ResultSet: userId={}\", userId, e);\n            // 개별 사용자 처리 실패가 전체 처리를 중단하지 않도록 예외를 로깅만 하고 계속 진행\n        }\n    }\n}",
  "analysisMetadata": {
    "totalLines": 105,
    "astAnalysisSuccess": true,
    "patternsChecked": 5,
    "safePatterns": 0,
    "antiPatterns": 5,
    "analysisTimestamp": "2025-10-02T05:08:06.133Z"
  },
  "summary": "VectorDB의 동적 패턴 분석을 통해 6개의 문제가 발견되었습니다. 0개의 안전한 패턴과 5개의 문제 패턴을 참고하여 분석했습니다."
}